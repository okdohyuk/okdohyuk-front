#!/usr/bin/env sh
# shellcheck shell=sh

set -e

cd -- "$(dirname "$0")/.." || exit 1

commit_msg_file="$1"
commit_msg="$(cat "$commit_msg_file")"

pattern='^(feat|fix|refactor|docs|enhance|chore|test|perf|build|ci|style|revert|hotfix|release)(\([a-z0-9\-\/]+\))?: .+'

if printf '%s' "$commit_msg" | grep -Eq "$pattern"; then
  exit 0
fi

cat <<'EOF'
âŒ Invalid commit message.

Format: <type>: <description>
Allowed types: feat, fix, refactor, docs, enhance, chore, test, perf, build, ci, style, revert, hotfix, release
Example: feat: add user onboarding flow
EOF

exit 1
